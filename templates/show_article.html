{% extends 'base.html' %}
{% block content %}
<div class="contents space">
    <div class="article-contents">
        <div class="article-name">
            <h1>{{ blogarticle.title }}</h1>
            <p>投稿主：{{ user_name }}</p>
            {% if like_check == True %}
            <a href='/like/{{ blogarticle.id }}' class="no-under"><p class="like-count"><span class="fas fa-heart heart red"></span>{{ like_count }}←やってみたい！</p></a>
            {% else %}
            <a href='/like/{{ blogarticle.id }}' class="no-under"><p class="like-count"><span class="fas fa-heart heart"></span>{{ like_count }}←やってみたい！</p></a>
            {% endif %}
        </div>
        {% for tag in tags %}
        <p class='article-tag tag{{ tag.type_id }}'>{{ tag.name }}</p>
        {% endfor %}
        <div class="article-photo">
            <img src="../static/image/{{ blogarticle.image }}">
        </div>
        <div class="article-content">
            {% for content in contents %}
            {% if content.content_type == "headline" %}
            <h2 class="headline">{{ content.text}}</h2>
            {% elif content.content_type == "body" %}
            <p class="body">{{ content.text}}</p>
            {% endif %}
            {% endfor %}
        </div>
        <form method="POST" >
            <!-- ログインしていないと書き込めない -->
            {% if current_user.is_authenticated %}
            <div>
                <input type="text" name="comment">
            </div>
            <input type="submit" value="感想をつたえる">
            {% endif %}
        </form>
        <!-- ここbuttonじゃないとエラー出る -->
        {% if current_user.is_authenticated %}

            {% else %}
            <!-- コメントが出る -->
            <a href='/login_session/{{blogarticle.id}}'><button >ログインして感想を伝える！</button></a>
            {% endif %}

            <div class="article-comment">
                {% for comment in comments %}
                    {{ comment_names[comment.contributor_id]}}
                    {{ comment.text}}

                    {% if comment.contributor_id == current_user.id %}
                        <form method="POST" >
                        <!-- ログインしていてかつ　コメントを投稿したことがあると削除マーク表示-->
                        {% if current_user.is_authenticated %}
                            <a href="/delete_comment/{{ blogarticle.id}} /{{ comment.id }}  role="button">削除</a>
                        {% endif %}
                        </form>
                    {% endif %}
                    <p></p>
                {% endfor %}   
            </div>

</div>
{% endblock %}